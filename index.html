<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Daily Stats</title>
<style>
  body { font-family: sans-serif; padding: 1rem; }
  table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
  th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
</style>
</head>
<body>

<h1>Daily Stats</h1>
<input type="date" id="day" />
<button onclick="loadData()">Cargar</button>

<div id="error" style="color:red; margin-top:1rem;"></div>
<table id="statsTable" style="display:none;">
  <thead>
    <tr>
      <th>Campo</th>
      <th>Valor</th>
    </tr>
  </thead>
  <tbody id="statsBody"></tbody>
</table>

<script>
async function loadData() {
  const day = document.getElementById('day').value;
  const url = '/api/daily' + (day ? '?day=' + day : '');
  const errorDiv = document.getElementById('error');
  const table = document.getElementById('statsTable');
  const tbody = document.getElementById('statsBody');
  
  errorDiv.textContent = '';
  table.style.display = 'none';
  tbody.innerHTML = '';

  try {
    const res = await fetch(url);
    if (!res.ok) throw new Error(res.status);
    const data = await res.json();

    for (const [k, v] of Object.entries(data)) {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${k}</td><td>${JSON.stringify(v)}</td>`;
      tbody.appendChild(tr);
    }
    table.style.display = '';
  } catch(e) {
    errorDiv.textContent = 'Error: ' + e.message;
  }
}
</script>

</body>
</html>